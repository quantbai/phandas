回測詳解
========

理解回測結果中的每個指標。

回測參數
--------

::

    result = factor.backtest(
        start_date='2022-01-01',      # 開始日期
        end_date='2024-12-31',        # 結束日期
        transaction_cost=0.0003,      # 交易成本 0.03%
        full_rebalance=False,         # 是否每日重新平衡
    )

關鍵指標
--------

1. **Total Return** - 總收益百分比
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

::

    Total Return = (final_value - initial_value) / initial_value * 100%
    
    例：初始 100,000 USD，最後 225,300 USD
    → Total Return = 125.3%

2. **Annual Return** - 年化收益
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

::

    年化收益 = (總收益) ^ (1/年數) - 1
    
    例：2 年收益 100%
    → 年化 = (1 + 1) ^ (1/2) - 1 = 41.4%

3. **Sharpe Ratio** - 風險調整收益
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

每單位風險賺取的收益。越高越好。

::

    Sharpe > 1.0  = 優秀
    Sharpe > 0.5  = 可接受
    Sharpe < 0.5  = 需要改進

4. **Max Drawdown** - 最大回撤
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

從最高點到最低點的最大跌幅。

::

    例：最高 225,300 USD，後來跌到 184,500 USD
    → Max Drawdown = -18.2%

5. **Win Rate** - 獲勝天數比例
~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~~

::

    52% = 平均略好於隨機（隨機 = 50%）
    > 55% = 較好的策略
    > 60% = 優秀策略

查看詳細結果
-------------

::

    # 日收益序列
    print(result.daily_return)
    
    # 月度收益表
    print(result.monthly_return)
    
    # 每個資產的貢獻度
    print(result.contribution_by_symbol)
    
    # 繪製回測曲線
    result.plot()

解釋結果的常見問題
------------------

**Q: 為什麼夏普比很高但回測賺不到錢？**

A: 可能是過擬合。檢查：
   - 是否使用了未來數據
   - 參數是否過度優化
   - 樣本外測試

**Q: 最大回撤 -50% 是否接受？**

A: 取決於你的風險承受度：
   - < 20% = 穩健策略
   - 20% - 40% = 中等風險
   - > 40% = 高風險

